%section#breadcrumbs
  %nav
    = link_to "Home", root_path
    >
    Bekijk de Mixes van anderen

%section#top
  %h2 Bekijk de EnergyMixes van anderen
  = form_tag scenarios_path, :method => :get, :remote => true do
    = text_field_tag :q, params[:q], :placeholder => "Zoeken"

%section#scenarios
  = form_tag compare_scenarios_path do
    %section#left
      #selected
        = link_to_function "Vergelijk", "$('#scenarios form').submit()"
        %span.compared
        .scenarios
      #user_scenarios.selectable
        = render :partial => 'select_scenario_box', :collection => @scenarios, :as => :scenario
        #pagination
          = paginate @scenarios, :remote => true
    %section#right
      %h3 Gemiddelde per leeftijcategorie
      #featured_scenarios.selectable
        = render :partial => 'select_scenario_box', :collection => @featured_scenarios, :as => :scenario

- content_for :head do
  = stylesheet_link_tag 'scenarios'
  = javascript_include_tag 'jquery.busy.min'
  :javascript
    $(function(){
      // let's deal with the back button
      $(".selectable .scenario input").attr("checked", false);
      $("#selected .scenario input").attr("checked", true);
      // adding an element
      $(".selectable .scenario input").live('change', function(){
        if($("#selected .scenario input").length >= 5) {
          $(this).attr('checked', false);
          alert("You can select up to 5 scenarios");
          return false;
        }
        $(this).attr('checked', true);
        var name = $(this).parent().parent().parent().find(".name a").html();
        $("#selected .compared").append(" " + name);
        $(this).parent().parent().parent().appendTo("#selected .scenarios");
      });
      
      $("body").ajaxStart(function(){
        $("#user_scenarios").busy({img: '/images/spinner.gif'});
      });
    });
    
    