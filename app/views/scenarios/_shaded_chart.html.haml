:ruby
  max_height = local_assigns.has_key?(:max_height) ? max_height : 390
  max_amount = local_assigns.has_key?(:max_amount) ? max_amount : Scenario::MaxAmount
  width = 50
  rounded_sum = 0
  current_chart_height = scenario.total_amount / max_amount.to_f * max_height

.shaded_chart
  %header Energy Mix 2011
  %header.sub
    = number_with_precision(scenario.total_amount / 1_000_000_000, :precision => 1, :separator => ".")
    Mld

  .charts_container.static
    .chart_canvas_mix{:style => "width: #{width}px"}
      %ul.chart
        - scenario.carrier_ratios.each_pair do |carrier, value|
          - height = (value * current_chart_height).round
          %li.serie{:class => [carrier, Scenario::PrimaryMixTable[carrier]], :style => "height: #{height}px", :title => I18n.t(carrier)}
    = render 'renewables_float', :scenario => scenario
